import{I as r}from"./InstallationStep.916efcd3.js";import{_ as d,E as h,H as m,r as c,o as p,c as v,d as u,w as f,e as i}from"./index.2e5144e1.js";import{x as g,a as E}from"./xterm.9c673174.js";const I=[{title:"Platform",active:!1},{title:"Environment",active:!1},{title:"Variables",active:!1},{title:"Install",active:!0}],_="",b={components:{InstallationStep:r},data(){return{terminal:null,installing:!1,steps:I,tips:_,navigation:{next:{path:`/environments/${this.$store.state.installationState.id}`,disabled:!1,text:"Install",onClick:()=>{this.install()}},back:{path:"/variables",disabled:!1},cancel:{path:this.$store.state.editingEnvironment?`/environments/${this.$store.state.installationState.id}`:"/",disabled:!1}}}},methods:{updateTerminal(t){this.terminal.write(t+`\r
`)},install(){this.installing=!0,this.navigation.next.disabled=!0,this.navigation.cancel.disabled=!0,this.navigation.back.disabled=!0,this.$store.state.editingEnvironment?this.editInstalledEnvironment():(this.updateTerminal("Installing EPOS Open Source on your system"),this.updateTerminal("Installing..."),this.installNewEnvironment())},installNewEnvironment(){let t=this.$store.state.installationState.platform,s=this.$store.state.installationState.environmentSetup,a=this.$store.state.installationState.variables,l=this.$store.state.installationState.skipImagesAutoupdate,n=!!this.$store.state.editingEnvironment;h("TERMINAL_OUTPUT",e=>{this.updateTerminal(e)}),m(t,s,a,l,n).then(()=>{this.finishInstallation()}).catch(e=>{this.updateTerminal(`
Installation failed:\r
`),this.updateTerminal("Error: "+e+`\r
`),this.installationError()})},editInstalledEnvironment(){this.updateTerminal(`
Editing the installed environment\r
`),this.updateTerminal(`Editing...\r
`),this.installNewEnvironment()},finishInstallation(){this.installing=!1,this.navigation.next.disabled=!1,this.updateTerminal(`
Installation finished successfully!`),this.navigation.next.onClick=null,this.navigation.next.text="See in Installed Environments"},installationError(){this.installing=!1,this.navigation.next.disabled=!0,this.navigation.cancel.disabled=!1,this.navigation.back.disabled=!1}},mounted(){this.terminal=new g.exports.Terminal({fontSize:13,theme:{background:"#111111"},rows:25,fontFamily:"monospace",cursorInactiveStyle:"none"});const t=new E.exports.FitAddon;this.terminal.loadAddon(t),this.terminal.open(this.$refs.terminal),t.fit(),window.addEventListener("resize",()=>{t.fit()}),this.$store.state.editingEnvironment?this.updateTerminal(`Press 'Install' to start the editing process.\r
`):this.updateTerminal(`Press 'Install' to start the installation process.\r
`)}},x={class:"install-container"},S={class:"install-main-content-container"},T=i("h1",{class:"install-title"},"Install",-1),$={class:"install-main-content"},w={class:"terminal-output",ref:"terminal"};function k(t,s,a,l,n,e){const o=c("InstallationStep");return p(),v("div",x,[u(o,{navigation:n.navigation,steps:n.steps,tips:n.tips},{default:f(()=>[i("div",S,[T,i("div",$,[i("div",w,null,512)])])]),_:1},8,["navigation","steps","tips"])])}const P=d(b,[["render",k]]);export{P as default};
