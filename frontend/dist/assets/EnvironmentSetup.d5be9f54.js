import{I as g}from"./InstallationStep.916efcd3.js";import{_ as x,L as S,u as l,p as _,q as b,r as d,o,c as r,d as v,w as E,F as u,e as s,s as m,v as h,x as I,h as C,t as V,g as c}from"./index.2e5144e1.js";const k=[{title:"Platform",active:!1},{title:"Environment",active:!0},{title:"Variables",active:!1},{title:"Install",active:!1}],w="Choose a name and version for the environment. The name and version will be used to identify the environment so they have to be unique. <br><br>You will find the environment by its name and version in the Installed Environments section in the Home.",y={components:{InstallationStep:g,LoadingSpinner:S},data(){return{steps:k,tips:w,warning:!1,contexts:null,loadingContexts:!1}},computed:{platform:{get(){return this.$store.state.installationState.platform},set(t){this.$store.commit("setPlatform",t)}},name:{get(){return this.$store.state.installationState.environmentSetup.name},set(t){this.$store.commit("setEnvironmentName",t)}},version:{get(){return this.$store.state.installationState.environmentSetup.version},set(t){this.$store.commit("setEnvironmentVersion",t)}},context:{get(){return this.$store.state.installationState.environmentSetup.context},set(t){this.$store.commit("setEnvironmentContext",t)}},navigation(){return{next:{path:"/variables",disabled:this.name===""||this.version===""||this.name===null||this.version===null||this.warning,onClick:this.nextButtonClick},back:{path:this.$store.state.editingEnvironment?`/environments/${this.$store.state.installationState.id}`:"/platform",disabled:!1},cancel:{path:this.$store.state.editingEnvironment?`/environments/${this.$store.state.installationState.id}`:"/",disabled:!1}}}},methods:{nextButtonClick(){l().state.installationState.id=l().state.installationState.environmentSetup.name+"-"+l().state.installationState.environmentSetup.version+"-"+l().state.installationState.platform,this.$router.push(this.navigation.next.path)},validateAndSetName(t){let e;this.platform==="kubernetes"?e=t.target.value.replace(/[^a-z0-9-]/g,""):e=t.target.value.replace(/[^a-zA-Z0-9-]/g,""),t.target.value=e,this.name=e,this.isEnvironmentInstalled()},validateAndSetVersion(t){let e=t.target.value.replace(/[^0-9.]/g,"");t.target.value=e,this.version=e,this.isEnvironmentInstalled()},isEnvironmentInstalled(){if(this.$store.state.editingEnvironment){let t=this.$store.state.editingEnvironment.environmentSetup.name,e=this.$store.state.editingEnvironment.environmentSetup.version;if(this.name===t&&this.version===e)return}_(this.name,this.version,this.platform,this.context).then(t=>{this.warning=t})}},mounted(){this.isEnvironmentInstalled(),this.platform==="kubernetes"&&(this.loadingContexts=!0,b().then(t=>{this.contexts=t,this.context=this.contexts[0],setTimeout(()=>{this.loadingContexts=!1},1e3)}))}},N={class:"environment-setup-main-content-container"},A=s("h1",{class:"environment-setup-title"},"Environment setup",-1),L={class:"environment-setup-main-content"},B={autocomplete:"off"},$={class:"environment-setup-form-field"},P=s("label",{for:"name"},"Name:",-1),T={class:"environment-setup-form-field"},U=s("label",{for:"version"},"Version:",-1),q={key:0,class:"environment-setup-form-field"},z=s("label",{for:"context"},"Context:",-1),D=s("option",{disabled:"",value:""},"Please select one",-1),F=["value"],K={key:0,class:"environment-setup-warning"};function M(t,e,G,H,a,i){const p=d("LoadingSpinner"),f=d("InstallationStep");return o(),r(u,null,[v(p,{isLoading:a.loadingContexts,text:"Loading Kubernetes Contexts"},null,8,["isLoading"]),v(f,{steps:a.steps,tips:a.tips,navigation:i.navigation},{default:E(()=>[s("div",N,[A,s("div",L,[s("form",B,[s("div",$,[P,m(s("input",{type:"text",id:"name",name:"name",maxlength:"40",onInput:e[0]||(e[0]=(...n)=>i.validateAndSetName&&i.validateAndSetName(...n)),"onUpdate:modelValue":e[1]||(e[1]=n=>i.name=n)},null,544),[[h,i.name]])]),s("div",T,[U,m(s("input",{type:"text",id:"version",name:"version",maxlength:"20",onInput:e[2]||(e[2]=(...n)=>i.validateAndSetVersion&&i.validateAndSetVersion(...n)),"onUpdate:modelValue":e[3]||(e[3]=n=>i.version=n)},null,544),[[h,i.version]])]),i.platform==="kubernetes"?(o(),r("div",q,[z,m(s("select",{id:"context",name:"context","onUpdate:modelValue":e[4]||(e[4]=n=>i.context=n),class:"environment-setup-select"},[D,(o(!0),r(u,null,C(a.contexts,n=>(o(),r("option",{value:n,key:n},V(n),9,F))),128))],512),[[I,i.context]])])):c("",!0)]),a.warning?(o(),r("p",K," An environment with the same name and version already exists. Please choose a different name or version. ")):c("",!0)])])]),_:1},8,["steps","tips","navigation"])],64)}const j=x(y,[["render",M]]);export{j as default};
